trigger:
  branches:
    include:
      - azure-pipeline

variables:
  azureServiceConnectorId: "4xRSzfyQsWHgVrXhRmGqge1coGgm8uToZlpJCy72Ql1zqVrqiZcpJQQJ99BDACAAAAAof4MaAAASAZDOLRwI"
  appName: "app-1-uEUzFWp"
  appType: "webAppLinux"
  pythonVersion: "3.12"

pool:
  name: Local

stages:
  - stage: Deploy
    displayName: Deploy
    jobs:
      - job: DeployApp
        steps: 
        - script: |
              python -m venv env
              source env/bin/activate
              pip install --no-cache-dir -r app/requirements.txt
          displayName: "Install dependencies"
        
        - task: AzureWebApp@1
          inputs:
            azureSubscription: "$(azureServiceConnectorId)"
            appName: "$(appName)"
            appType: webAppLinux
            package: "$(System.DefaultWorkingDirectory)"
          displayName: "Deploy to Azure App Service"

